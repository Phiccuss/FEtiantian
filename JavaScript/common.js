var TIME="3000";var totalSize="";var totalInterval=null;var _hmt=_hmt||[];var originMenus;var menuList;var moreList;var flutterAjaxInterval=null;var flutterAjaxAgain=false;(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{if(typeof exports==="object"){module.exports=b(require("jquery"))}else{a.returnExports=b(a.jQuery)}}}(this,function(d){if(navigator.userAgent.match(/axpzhkt/i)){c()}var g=document.createElement("script");g.src="https://hm.baidu.com/hm.js?8b2d016c7a7351dc6cce42ca30b2632b";var b=document.getElementsByTagName("title")[0];b.parentNode.insertBefore(g,b);d.extend({getRequest:function(k){var j=location.search;var h=new Object();if(j.indexOf("?")!=-1){var m=j.substr(1);strs=m.split("&");for(var l=0;l<strs.length;l++){h[strs[l].split("=")[0]]=strs[l].split("=")[1]}}return h[k]},isMobile:function(){var h=navigator.userAgent;if(h.match(/Android/i)||h.match(/webOS/i)||h.match(/iPhone/i)||h.match(/iPad/i)||h.match(/iPod/i)||h.match(/BlackBerry/i)||h.match(/Windows Phone/i)||d.isHandIOS()){return true}else{return false}},getToken:function(){var j=navigator.userAgent;if(j.match(/axpzhkt/i)){var k=new Date().getTime();var h=window.sessionStorage.getItem("lastTokenTime");if(h&&((k-h)<5*60*1000)){var l="Bearer "+window.sessionStorage.getItem("token")}else{var i=androidProxy.getToken();var l="Bearer "+i;window.sessionStorage.setItem("token",i);window.sessionStorage.setItem("lastTokenTime",k)}}else{var i=d.getRequest("token");if(i!=""&&i!=null&&i!=undefined){window.sessionStorage.setItem("token",i);var l="Bearer "+i;d.deleteUrlToken(i)}else{var l="Bearer "+window.sessionStorage.getItem("token")}}return l},deleteUrlToken:function(i){var k=window.location.search;var j="";var h=window.location.href.split("?")[0];if(k.indexOf("?token=")>=0){j="token="+i;k=k.replace(j,"");if(k.length>1){k=k.substr(2);h+="?"+k}}else{if(k.indexOf("&token=")>=0){j="&token="+i;k=k.replace(j,"");h+=k}}history.replaceState(null,null,h)},getLinkWebsParameter:function(j){var l={callbackfn:function(){},};var l=d.extend(l,j);var k=loadSchoolConfig();if(k.userId){window.sessionStorage.setItem("lw_sign",k.linkWebSign);window.sessionStorage.setItem("lw_time",k.linkWebTime);window.sessionStorage.setItem("lw_userId",k.userId);window.sessionStorage.setItem("lw_liveCount",0);var h=window.location.protocol||"http";var i=k.schoolIp||"";i=h+i.substr(i.indexOf(":")+1);window.sessionStorage.setItem("lw_schoolIp",i);window.localStorage.setItem("lw_schoolIp",i);window.sessionStorage.setItem("onlyRes",k.onlyRes);l.callbackfn(k.onlyRes)}else{if(k.errObj){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(k.errObj)}else{d.getErrorMsg(k.errObj,"",{refreshTokenCallback:function(){d.getLinkWebsParameter()},storageName:"common-link-webs-params"})}}}},getErrorMsgCode:function(h){layui.use(["layer"],function(){var i=layui.layer;i.msg(h,{time:3000})})},getErrorMsg:function(l,j,i){if(i){var k=sessionStorage.getItem(i.storageName);var h=k!=null?Number(k):0}layui.use(["layer"],function(){var n=layui.layer;if(l.status==401){if(navigator.userAgent.match(/axpzhkt/i)){var m=new Date().getTime()-10*60*1000;window.sessionStorage.setItem("lastTokenTime",m);alert(JSON.stringify({type:402}))}else{if(i&&window.UAINFO().name=="AixueStu"&&window.UAINFO().version>=10){flutterAjaxAgain=false;var o=sessionStorage.getItem(i.storageName);if(o!=null&&Number(h)>0){sessionStorage.removeItem(i.storageName);document.location="mobile://exit?msg=刷新token失败";return}else{sessionStorage.setItem(i.storageName,(h)+1);document.location="mobile://refreshtoken";if(flutterAjaxInterval){clearInterval(flutterAjaxInterval)}flutterAjaxInterval=setInterval(function(){if(flutterAjaxAgain){clearInterval(flutterAjaxInterval);flutterAjaxInterval=null;if(i.refreshTokenCallback){i.refreshTokenCallback()}}},100)}}else{n.msg("您已退出，请重新登录！",{time:3000},function(){var q=window.localStorage.getItem("lw_schoolIp");window.sessionStorage.removeItem("token");if(!q){q="http://web.etiantian.com/digitalschool/"}if(window.sessionStorage.getItem("ssoAddress")){q=window.sessionStorage.getItem("ssoAddress")}if(d.getCookieByName("ssoAddress")){q=d.getCookieByName("ssoAddress")}window.location.href=q})}}}else{if(l.status==404){if(j){n.msg(j+"请求失败，请求未找到，404",{time:3000})}}else{if(l.status==503||l.status==500){if(l&&l.responseJSON&&(l.responseJSON.code==-200000001||l.responseJSON.code==-200000002)){var p=l.responseJSON.msg.replace(("{"+l.responseJSON.code+"}"),"");n.msg(p,{time:3000})}else{if(j){n.msg(j+"请求失败，服务器内部错误",{time:3000})}}}else{if(j){n.msg(j+"请求失败,网络连接超时",{time:3000})}}}}})},removeRefreshTokenFlag:function(h){if(sessionStorage.getItem(h)&&Number(sessionStorage.getItem(h))>0){sessionStorage.removeItem(h)}},resErrorHandle:function(h){layui.use(["layer"],function(){var j=layui.layer;if(h.status==401){if(navigator.userAgent.match(/axpzhkt/i)){var i=new Date().getTime()-10*60*1000;window.sessionStorage.setItem("lastTokenTime",i);alert(JSON.stringify({type:402}))}else{if(d.getRequest("pageSource")=="areaPlat"){window.sessionStorage.removeItem("token");window.location.reload()}else{j.msg("您已退出，请重新登录！",{time:3000},function(){var k=window.localStorage.getItem("lw_schoolIp");window.sessionStorage.removeItem("token");if(!k){k="http://web.etiantian.com/digitalschool/"}if(window.sessionStorage.getItem("ssoAddress")){k=window.sessionStorage.getItem("ssoAddress")}window.location.href=k})}}}})},getNavigations:function(i){var l={name:"",isIndex:false,isResources:false,isChat:false,url:"../index/index.html",type:"",thepage:""};var l=d.extend(l,i);jQuery.support.cors=true;var j=Number(d.GetUrlParam("isFromExam")||0);j=Boolean(j);var h=d.GetUrlParam("examTitle");if(j&&!l.isIndex){var k='<div class="exam-header"><div class="header-back">&lt;&nbsp;&nbsp;返回</div><div class="header-title">'+h+"</div></div>";d(".fixed-nav").html(k);d(".fixed-nav").on("click",".header-back",function(){window.history.back()});d(".layui-breadcrumb").hide()}else{d.getLinkWebsParameter({callbackfn:function(n){d.getWebAiXueParams();if(navigator.userAgent.match(/axpzhkt/i)||d.isLargeAixuePad53()){if(!sessionStorage.getItem("schoolId")){var o=loadSchoolConfig();if(o.userId){var m=typeof o.schoolId=="undefined"?0:o.schoolId;sessionStorage.setItem("schoolId",m)}}return}var p=d.getToken();var o=loadSchoolConfig();if(o.userId){if(o.roles[0]!=1){d.ajax({url:BASE_API_URL+"/api-service-general/indexes/navigations-new",type:"GET",dataType:"json",data:{r:Math.random()},beforeSend:function(q){q.setRequestHeader("Authorization",p)},success:function(w){var s=window.sessionStorage.getItem("lw_sign");var t=window.sessionStorage.getItem("lw_time");var x=window.sessionStorage.getItem("lw_userId");var z=window.sessionStorage.getItem("lw_schoolIp");var u=window.location.origin+"/ecampus";var v=w.data.menuList;v.unshift({menuId:0,menuName:"首页",menuUrl:u+"/index/index.html",list:null,sortId:null,token:null,type:null,});console.log("initMenus",v);originMenus=v.map((function(D){D.realUrl=D.menuUrl;D.target="_self";if(D.list){for(var B=0,A=D.list.length;B<A;B++){var C=D.list[B];C.realUrl=C.menuUrl;C.target="_self";if(D.menuName=="名师课堂"||D.menuName=="专递课堂"){C.jump="click"}if(D.menuName=="考试阅卷"){C.jump="click2"}d.setMenuOption(C)}}else{if(D.menuName=="考试阅卷"){D.jump="click2"}d.setMenuOption(D)}return D}));var r=w.data.headImage;l.headImage=w.data.headImage;var q=Math.floor((window.innerWidth-387)/120)-1;sessionStorage.setItem("navNum",q);var y=d.getNavbarStr(q,l);d(".fixed-nav").html(y);d(".stu-evaluate-btn").off("click").on("click",function(){var A=d(this);d.ajax({url:BASE_API_URL+"/evaluation-service/home/load-only-teacher?r="+Math.random(),type:"GET",dataType:"json",beforeSend:function(B){B.setRequestHeader("Authorization",p)},success:function(B){if(B.code==1){if(B.data.onlyTeacher){if(B.data.msg){layui.use(["layer"],function(){var C=layui.layer;C.msg(B.data.msg,{time:3500})})}else{window.open(SZPJ_URL+"/xspingjia/index.html#/mark?periodId="+B.data.periodId+"&token="+A.attr("data-tok"))}}else{window.open(SZPJ_URL+"/xspingjia/index.html#/home?token="+A.attr("data-tok"))}}},error:function(B){d.getErrorMsg(B,"")}})});d.getSlideNavbar(l);d.getLogo();d.bindNavActions();d.bindIndexActions();d(".js-btn-signout").off("click").on("click",function(){d.ecSignOut()});d(document).on("click",".menu-zhongqing-link",function(){var C=d(this);if(C.attr("href")!="javascript:;"){return}var D=d.getToken();var B=C.attr("data-menuid");var A=C.attr("data-manage");if(B&&A){d.ajax({url:BASE_API_URL+"/business-service-general/login/zq/user",type:"get",dataType:"json",data:{r:Math.random(),nav:B,manage:A,token:D},beforeSend:function(E){E.setRequestHeader("Authorization",D)},success:function(F){var E=F.data;if(E.indexOf("http")<0){E="http://"+E}window.open(E,"_target")},error:function(E){}})}else{console.log("menu-zhongqing-link if");d.ajax({url:BASE_API_URL+"/api-service-general/zrt/account/zrt-mark-url",type:"get",dataType:"json",data:{r:Math.random(),},beforeSend:function(E){E.setRequestHeader("Authorization",D)},success:function(E){console.log("res",E);if(E.code==1){window.open(E.data.markUrl,"_blank")}},error:function(E){}})}});window.addEventListener("resize",function(){var A=Math.floor((window.innerWidth-387)/120)-1;if(sessionStorage.getItem("navNum")!=A){d.getNavbarMenus(A,l);d.bindNavActions()}})},error:function(q){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(q)}else{d.getErrorMsg(q,"公共导航")}}});if(d.getRequest("pageSource")!="schoolGroup"){d.getPasswordPopup(i.updatePasswordCallback)}else{if(i.updatePasswordCallback&&typeof i.updatePasswordCallback=="function"){i.updatePasswordCallback()}}}}}})}},isLargeAixuePad53:function(){var k=false;var i=navigator.userAgent.indexOf("axp-study-analysis");if(i>-1){var j=navigator.userAgent.indexOf("aixuepad");if(j>-1){var h=Number(navigator.userAgent.substring(i+"axp-study-analysis".length,j));if(h>=21122101){k=true}}}return k},setMenuOption:function(j){var i=["我的课程","大数据中心","积分兑换","平台管理","名校试题"];var h=[16,18,11,12,20];var l=window.location.origin+"/ecampus";var k=window.sessionStorage.getItem("lw_sign");var m=window.sessionStorage.getItem("lw_time");var n=window.sessionStorage.getItem("lw_userId");if(j.menuName=="智慧作业"){j.realUrl=l+"/task/index.html?token="+sessionStorage.getItem("token")}else{if(j.menuName=="资源库"){j.realUrl=l+"/resources/index.html"}else{if(j.menuName=="选题组卷"){j.realUrl=window.location.origin+"/digitalcampus/#/onlinePaper"}else{if(j.menuName=="考试分析"){j.realUrl=window.location.origin+"/paperdata/#/examList?token="+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuName=="个性化学习"){j.realUrl=l+"/hiven/teacher.html?token="+sessionStorage.getItem("token")}else{if(j.menuName=="教研中心"){j.realUrl=window.location.origin+"/jiaoyan/index.html#/resourcelist?source=1&token="+sessionStorage.getItem("token")}else{if(j.menuName=="远程教研"){j.realUrl=window.location.origin+"/survey/#/?token="+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuName=="教研共同体"){j.realUrl=window.location.origin+"/survey/#/?userType=24&token="+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuId==42){j.realUrl=window.location.origin+"/cultivate/#/resList?userGrade=1&token="+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuId==43){j.realUrl=(window.location.origin.indexOf("ai-classes")>-1?window.location.origin+"/flutter_gspy/#/gkpy/statistics?gradeId=1&sectionId=1&token=":"https://int.etiantian.com/flutter_gspy/#/gkpy/statistics?gradeId=1&sectionId=1&token=")+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuId==49){j.realUrl=(window.location.origin.indexOf("ai-classes")>-1?window.location.origin+"/flutter_gspy/#/gkpy/statistics?gradeId=4&sectionId=2&token=":"https://int.etiantian.com/flutter_gspy/#/gkpy/statistics?gradeId=4&sectionId=2&token=")+sessionStorage.getItem("token");j.target="_blank"}else{if(j.menuId==47){j.realUrl=window.location.origin+"/cultivate/#/resList?userGrade=4&token="+sessionStorage.getItem("token");j.target="_blank"}else{var o=i.indexOf(j.menuName);if(o>-1){var p=h[o];j.realUrl=window.location.origin+"/dl910/linkWeb?m=pageRedirect&sign="+k+"&time="+m+"&userId="+n+"&flagId="+p+"&token="+window.sessionStorage.getItem("token");j.target="_blank"}}}}}}}}}}}}}},getNavbarMenus:function(o,j){menuList=originMenus.slice(0,o);moreList=originMenus.slice(o);var s="";var r='<ul class="nav navbar-nav">';for(var n=0,p=menuList.length;n<p;n++){var l=menuList[n];var q=l.menuName==j.name?"active":"";if(l.list){r+='<li class="dropdown dropdown-hover">';r+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">'+l.menuName+'<span class="caret"></span></a>';r+='  <ul role="menu" class="dropdown-menu">';for(var t=0,k=l.list.length;t<k;t++){var h=l.list[t];if(h.jump=="click"){r+='<li><a class="menu-zhongqing-link" data-manage="'+(h.type==2?1:0)+'" data-menuId="'+h.menuId+'" href="javascript:;">'+h.menuName+"</a></li>"}else{if(h.jump=="click2"){r+='<li><a class="menu-zhongqing-link" href="javascript:;">'+h.menuName+"</a></li>"}else{r+='<li><a href="'+h.realUrl+'" target="'+h.target+'">'+h.menuName+"</a></li>"}}}r+="  </ul>";r+="</li>"}else{if(l.menuId==29){s=l.token;r+='<li><a href="javascript:;" class="stu-evaluate-btn">'+l.menuName+"</a></li>"}else{r+='<li class="'+q+'"><a href="'+l.realUrl+'" target="'+l.target+'" class="anav">'+l.menuName+"</a></li>"}}}if(moreList.length>0){r+='<li class="dropdown dropdown-hover">';r+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">更多<span class="caret"></span></a>';r+='  <ul role="menu" class="dropdown-menu">';for(var n=0,p=moreList.length;n<p;n++){var m=moreList[n];if(m.list){r+='<li class="more-menu-item"><a href="javascript:;">'+m.menuName+'<span class="arrow"></span></a>';r+='<ul class="more-sub-container">';for(var t=0,k=m.list.length;t<k;t++){var h=m.list[t];if(h.jump=="click"){r+='<li><a class="menu-zhongqing-link" data-manage="'+(h.type==2?1:0)+'" data-menuId="'+h.menuId+'" href="javascript:;">'+h.menuName+"</a></li>"}else{if(h.jump=="click2"){r+='<li><a class="menu-zhongqing-link" href="javascript:;">'+h.menuName+"</a></li>"}else{r+='<li><a href="'+h.realUrl+'" target="'+h.target+'">'+h.menuName+"</a></li>"}}}r+="</ul>";r+="</li>"}else{if(m.menuId==29){s=m.token;r+='<li><a href="javascript:;" class="stu-evaluate-btn">'+m.menuName+"</a></li>"}else{r+='<li class="more-menu-item"><a href="'+m.realUrl+'" target="'+m.target+'">'+m.menuName+"</a></li>"}}}r+="  </ul>";r+="</li>"}r+=" </ul>";d("#navbar-right").html(r);d(".stu-evaluate-btn").off("click").on("click",function(){console.log(11);d.ajax({url:BASE_API_URL+"/evaluation-service/home/load-only-teacher?r="+Math.random(),type:"GET",dataType:"json",beforeSend:function(i){i.setRequestHeader("Authorization",_token)},success:function(i){if(i.code==1){if(i.data.onlyTeacher){if(i.data.msg){layui.use(["layer"],function(){var u=layui.layer;u.msg(i.data.msg,{time:3500})})}else{window.open(SZPJ_URL+"/xspingjia/index.html#/mark?periodId="+i.data.periodId+"&token="+s)}}else{window.open(SZPJ_URL+"/xspingjia/index.html#/home?token="+s)}}},error:function(i){d.getErrorMsg(i,"")}})})},getExamNavredPoint:function(){var h=d.getToken();d.ajax({url:BASE_API_URL+"/business-service-answersheet/exam/red-point",type:"get",dataType:"json",beforeSend:function(i){i.setRequestHeader("Authorization",h)},success:function(i){if(i.code==1&&i.data==1){d(".fixed-nav").find(".examNav").addClass("red-point")}},error:function(i){}})},getNavbarStr:function(n,p){menuList=originMenus.slice(0,n);moreList=originMenus.slice(n);var m=window.location.origin+"/ecampus";var j=m+"/index/index.html";var h=m+"/teauser/index.html?token="+sessionStorage.getItem("token");var t=[{menuName:"消息中心",menuUrl:m+"/message/index.html"},{menuName:"个人中心",menuUrl:m+"/teauser/index.html?token="+sessionStorage.getItem("token")},{menuName:"使用手册",menuUrl:"https://cdn1-school.ai-classes.com/fpupload/helpdoc/school/teacher/teacher_help.zip"},{menuName:"系统版本",menuUrl:m+"/vercontrol/timeline.html?token="+sessionStorage.getItem("token")}];var s='<nav class="navbar navbar-teacher navbar-static-top" role="navigation"> <div class="navbar-header">   <a href='+j+' class="navbar-brand"><img src="" /></a>   <div class="nav-btn-word"><span class="navbar-toggle-btn" data-activates="slide-out" ></span><span  class="navbar-toggle-btn-w">首页</span></div> </div><div class="navbar-right" id="navbar-right"> <ul class="nav navbar-nav">';for(var w=0,x=menuList.length;w<x;w++){var k=menuList[w];var l=k.menuName==p.name?"active":"";if(k.list){s+='<li class="dropdown dropdown-hover">';s+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">'+k.menuName+'<span class="caret"></span></a>';s+='  <ul role="menu" class="dropdown-menu">';for(var y=0,z=k.list.length;y<z;y++){var q=k.list[y];if(q.jump=="click"){s+='<li><a class="menu-zhongqing-link" data-manage="'+(q.type==2?1:0)+'" data-menuId="'+q.menuId+'" href="javascript:;">'+q.menuName+"</a></li>"}else{if(q.jump=="click2"){s+='<li><a class="menu-zhongqing-link" href="javascript:;">'+q.menuName+"</a></li>"}else{s+='<li><a href="'+q.realUrl+'" target="'+q.target+'">'+q.menuName+"</a></li>"}}}s+="  </ul>";s+="</li>"}else{if(k.menuName=="选题组卷"){s+='<li class="'+l+'"><a data-href="'+k.realUrl+'" data-target="'+k.target+'" class="anav select-paper">'+k.menuName+"</a></li>"}else{if(k.menuId==29){s+='<li><a href="javascript:;" data-tok="'+k.token+'" class="stu-evaluate-btn">'+k.menuName+"</a></li>"}else{if(k.menuId==36){var v=SZPJ_URL+"/paperdata/#/examList?token="+window.sessionStorage.getItem("token");s+='<li class="examNav"><a  href="'+v+'"target="_blank" class="anav">'+k.menuName+"</a></li>";d.getExamNavredPoint()}else{if(k.jump=="click2"){s+='<li><a class="'+l+'anav menu-zhongqing-link" href="javascript:;">'+k.menuName+"</a></li>"}else{s+='<li class="'+l+'"><a href="'+k.realUrl+'" target="'+k.target+'" class="anav">'+k.menuName+"</a></li>"}}}}}}if(moreList.length>0){s+='<li class="dropdown dropdown-hover">';s+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">更多<span class="caret"></span></a>';s+='  <ul role="menu" class="dropdown-menu">';for(var w=0,x=moreList.length;w<x;w++){var o=moreList[w];if(o.list){s+='<li class="more-menu-item"><a href="javascript:;">'+o.menuName+'<span class="arrow"></span></a>';s+='<ul class="more-sub-container">';for(var y=0,z=o.list.length;y<z;y++){var q=o.list[y];if(q.jump=="click"){s+='<li><a class="menu-zhongqing-link" data-manage="'+(q.type==2?1:0)+'" data-menuId="'+q.menuId+'" href="javascript:;">'+q.menuName+"</a></li>"}else{if(q.jump=="clic2"){s+='<li><a class="menu-zhongqing-link" href="javascript:;">'+q.menuName+"</a></li>"}else{s+='<li><a href="'+q.realUrl+'" target="'+q.target+'">'+q.menuName+"</a></li>"}}}s+="</ul>";s+="</li>"}else{if(o.menuId==29){s+='<li><a href="javascript:;" data-tok="'+o.token+'" class="stu-evaluate-btn">'+o.menuName+"</a></li>"}else{if(o.jump=="click2"){s+='<li><a class="menu-zhongqing-link" href="javascript:;">'+o.menuName+"</a></li>"}else{s+='<li class="more-menu-item"><a href="'+o.realUrl+'" target="'+o.target+'">'+o.menuName+"</a></li>"}}}}s+="  </ul>";s+="</li>"}s+=" </ul></div>";s+='   <div class="fl dropdown nav-header">';if(p.headImage!=undefined){s+='   <img src="'+p.headImage+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}else{s+='   <img src="'+DEFAULT_AVATAR+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}s+='<ul role="menu" class="dropdown-menu tooltip-demo">';if(p.isIndex){s+='<li><a href="javascript:;" class="js-btn-indexsys">增删模块</a></li>';s+='<li><a href="javascript:;" class="js-btn-indexdrag">模块布局</a></li>'}for(var w=0,x=t.length;w<x;w++){var u=t[w];s+='<li><a href="'+u.menuUrl+'">'+u.menuName+"</a></li>"}var r=d.judgePlatfrom();if(r==1){s+='<li class="signout" data-toggle="tooltip" data-placement="bottom" title="退出"><i class="icon-signout js-btn-signout">&nbsp;</i></li>'}s+="</ul>";s+="   </div>";s+="</nav>";if(p.isIndex){s+='<div class="tea-sortabletools sortabletools clearfix"><div class="tool"><div class="word">拖拽模块可任意调整布局，调整好后保存设置！</div><div class="fr" ><a class="dragged-cancel">取消</a><a class="dragged-save">保存</a></div></div></div>'}return s},getSlideNavbar:function(k){var r='<div id="slide-out" class="side-nav" >   <div  class="slide-logo"><img src="" /></div>       <ul class="slide-ul">';for(var o=0,p=originMenus.length;o<p;o++){var m=originMenus[o];if(m.list){r+=' <li class="slide-more-container"><a href="javascript:;" class="slide-more">'+m.menuName+'<span class="fa arrow"></span></a>';r+='<ul class="slide-ul2">';for(var n=0,l=m.list.length;n<l;n++){var h=m.list[n];if(h.jump=="click"){r+='<li><a class="menu-zhongqing-link" data-manage="'+(h.type==2?1:0)+'" data-menuId="'+h.menuId+'" href="javascript:;">'+h.menuName+"</a></li>"}else{if(h.jump=="click2"){r+='<li><a class="menu-zhongqing-link" href="javascript:;">'+h.menuName+"</a></li>"}else{r+='<li><a href="'+h.realUrl+'" target="'+h.target+'">'+h.menuName+"</a></li>"}}}r+="</ul>";r+="</li>"}else{if(m.menuName=="选题组卷"){r+='<li><a data-href="'+m.realUrl+'" class="anav select-paper"  data-target="'+m.target+'">'+m.menuName+"</a></li>"}else{if(m.jump=="click2"){r+='<li><a class="menu-zhongqing-link" href="javascript:;">'+m.menuName+"</a></li>"}else{if(m.menuName=="质检练习"){var q=SZPJ_URL+"/paperdata/#/examList?token="+window.sessionStorage.getItem("token");r+='<li><a href="'+q+'" class="anav"  target="_blank">'+m.menuName+"</a></li>"}else{r+='<li><a href="'+m.realUrl+'" class="anav"  target="'+m.target+'">'+m.menuName+"</a></li>"}}}}}r+="</ul>";r+="</div>";d("body").append(r)},bindNavActions:function(){d(".select-paper").off("click").on("click",function(){sessionStorage.removeItem("pageLevel");sessionStorage.removeItem("tabbarId");sessionStorage.removeItem("detailPaperId");sessionStorage.removeItem("pageSource");var i=d(this).attr("data-href");var j=d(this).attr("data-target");window.open(i,j)});d(".navbar-toggle-btn").off("click").on("click",function(){d("#slide-out").velocity({"margin-left":[0,-1*250]},{duration:300,queue:false,easing:"easeOutQuad"});var k=d("body");var i=d('<div id="sidenav-overlay"></div>');var j=k.innerWidth();k.css("overflow","hidden");k.width(j);i.css("opacity",0).click(function(){h();i.velocity({opacity:0},{duration:300,queue:false,easing:"easeOutQuad",complete:function(){d(this).remove()}})});d("body").append(i);i.velocity({opacity:0.7},{duration:300,queue:false,easing:"easeOutQuad",})});var h=function(i){d("body").css({overflow:"",width:""});d("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:false,easing:"easeOutQuad",complete:function(){d(this).remove()}});d("#slide-out").velocity({"margin-left":[-1*250,0]},{duration:200,queue:false,easing:"easeOutCubic"})};d(".slide-more").off("click").on("click",function(){d(this).parent("li").toggleClass("active")});d("li.dropdown-hover").off("click.bs.dropdown.data-api").find(".dropdown-menu").css("z-index",1200)},bindIndexActions:function(){d(".js-btn-indexsys").off("click").on("click",function(){layui.use(["layer"],function(){var h=layui.layer;h.open({type:1,closeBtn:1,btnAlign:"c",move:false,shade:[0.5,"#000000"],shadeClose:true,title:"增删模块",skin:"ecampus-class",area:["800px","380px"],content:d("#popup-indexsys"),btn:["确定"],success:function(i,j){d.getAllModules()},yes:function(j,i){var k="";d(i).find("input[name=allModules]").not("input[name=allModules]:checked").each(function(){k+=d(this).val()+","});if(k.substr(k.length-1)==","){k=k.substr(0,k.length-1)}var l=d.getToken();d.ajax({url:BASE_API_URL+"/api-service-general/indexes/modules",type:"put",dataType:"json",data:{r:Math.random(),moduleIds:k},beforeSend:function(m){m.setRequestHeader("Authorization",l)},success:function(m){if(m.code==1){h.close(j);d.inits({isFirst:false})}else{h.msg(e.msg,{time:3000})}},error:function(m){d.getErrorMsg(m,"保存设置")}})},btn2:function(j,i){h.close(j)}})})});d(".js-btn-indexdrag").off("click").on("click",function(){d.openSortable()});d(".dragged-cancel").off("click").on("click",function(){d.closeSortable()});d(".dragged-save").off("click").on("click",function(){d.saveSortable()})},getMenu:function(h){var i={name:"",isIndex:true,isResources:false,isChat:false,url:"../index/index.html",type:"",thepage:""};var i=d.extend(i,h);jQuery.support.cors=true;d.getLinkWebsParameter({callbackfn:function(m){d.getWebAiXueParams();var q=d.getToken();var p=loadSchoolConfig();if((p&&p.roles[0]===1)||(i.type===0||i.type==="0")||((i.type==14||i.type==23)&&(d.GetUrlParam("fromPage")==="stulist"||d.GetUrlParam("fromPage")==="microCourse"))){var j="https://cdn1-school.ai-classes.com/fpupload/helpdoc/school/student/student_help.zip";var o='<nav class="navbar navbar-static-top" role="navigation">';o+='    <div class="logo">';o+='       <a target="stuindex" href="../index/stuindex.html"><img src="" /></a>';o+="    </div>";o+='    <div class="notice"><a href="" target="stumessage" class="n-link"></a><span class="pub-time"></span></div>';o+='    <div class="navbar-right">';o+='        <div class="fl download dropdown dropdown-hover">';o+='            <a class="dropdown-toggle anav" data-hover="dropdown" data-close-others="true" style="display: none">下载APP</a>';o+='            <div role="menu" class="dropdown-menu dropdown-menu-rqcode">';o+='                <div class="dropdown-menu-rqcode-box">';o+='                    <div class="triangle"></div>';o+='                    <div class="dropdown-menu-rqcode-main">';o+='                        <div class="dropdown-menu-rqcode-imgb">';o+="                            <p>爱学</p>";o+='                            <img src="../images/qrcode_aixue.png" alt="">';o+="                        </div>";o+='                        <div class="dropdown-menu-rqcode-imgb">';o+="                        <p>家长圈</p>";o+='                            <img src="//cdn1-school.ai-classes.com/ecampus/images/qrcode_jiazhangquan.png" alt="">';o+="                        </div>";o+="                    </div>";o+="                </div>";o+="             </div>";o+="        </div>";o+='        <div class="fl stu-message-fl">';o+='            <a href="../stumessage/index.html" target="stumessage" title="" data-original-title="消息中心"><i class="icon-messages"></i></a>';o+="        </div>";o+='        <div class="fl dropdown stu-portrait">';o+='            <img src="" class="avatar dropdown-toggle" aria-expanded="false" data-toggle="dropdown" role="button" />';o+='            <ul role="menu" class="dropdown-menu">';o+='                <li><a href="../stuuser/index.html" target="stuuser" class="js-btn-indexsys">个人中心</a></li>';if(true){o+='              <li><a href="'+j+'" target="_blank" class="js-btn-indexsys">使用手册</a></li>'}o+='                <li class="signout js-btn-signout"><i class="icon-signout">&nbsp;</i></li>';o+="            </ul>";o+="        </div>";o+="    </div>";o+="</nav>";d(".fixed-nav").html(o);d.getstuLogo();try{if(location.pathname.indexOf("stuindex.html")!=-1){d.getNavNotice()}}catch(n){}d(".fixed-nav-student .navbar-right .stu-portrait").click(function(r){d(r).toggleClass("open")});d(".navbar-right .download").mouseover(function(){d(this).addClass("open")}).mouseout(function(){d(this).removeClass("open")})}else{d.ajax({url:BASE_API_URL+"/api-service-general/indexes/navigations",type:"GET",dataType:"json",async:false,data:{r:Math.random()},beforeSend:function(r){r.setRequestHeader("Authorization",q)},success:function(H){var I=window.sessionStorage.getItem("lw_sign");var G=window.sessionStorage.getItem("lw_time");var F=window.sessionStorage.getItem("lw_userId");var v=window.sessionStorage.getItem("lw_schoolIp");if(H.code==1){var J=v+"linkWeb?m=pageRedirect&sign="+I+"&time="+G+"&userId="+F+"&flagId=";var y="";if(i.isIndex||i.name=="答题卡"||i.name=="单元质检"||i.isResources){var A='<nav class="navbar navbar-static-top navbar-fixed-top" role="navigation">   <div class="navbar-header">       <a target="'+Math.random()+'" href='+i.url+' class="navbar-brand"><img src="" /></a>       <div class="nav-btn-word"><span class="navbar-toggle-btn" data-activates="slide-out" ></span><span  class="navbar-toggle-btn-w">首页</span></div>   </div><div class="navbar-right"><ul class="nav navbar-nav">';if(i.isIndex){A+='<li class="active"><a href="../index/index.html" class="anav">首页</a></li>'}if(i.name=="答题卡"||i.name=="单元质检"||i.isResources){A+='<li><a href="../index/index.html" class="anav">首页</a></li>'}var x=sessionStorage.getItem("token");for(var C=0;C<H.data.menuList.length;C++){if(H.data.menuList[C].menuUrl!=""&&H.data.menuList[C].menuUrl!=null&&H.data.menuList[C].menuUrl!=undefined){if(H.data.menuList[C].menuId==4){if(i.name=="资源库"){A+='<li class="active" data-id="'+H.data.menuList[C].menuId+'"><a href="../resources/index.html?token='+x+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{A+='<li data-id="'+H.data.menuList[C].menuId+'"><a href="../resources/index.html?token='+x+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}}else{if(H.data.menuList[C].menuId==23){if(i.name=="答题卡"){A+='<li class="active" data-id="'+H.data.menuList[C].menuId+'"><a href="'+window.location.origin+'/ecampus/task/index.html" class="anav">智慧作业</a></li>'}else{A+='<li data-id="'+H.data.menuList[C].menuId+'"><a href="'+window.location.origin+'/ecampus/task/index.html" class="anav">智慧作业</a></li>'}}else{if(H.data.menuList[C].menuId==36){A+='<li data-id="'+H.data.menuList[C].menuId+'"><a target="_blank" href="'+window.location.origin+"/paperdata/#/examList?token="+window.sessionStorage.getItem("token")+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{A+='<li  data-id="'+H.data.menuList[C].menuId+'"><a href="'+H.data.menuList[C].menuUrl+'" class="anav"  target="'+Math.random()+'">'+H.data.menuList[C].menuName+"</a></li>"}}}}else{if(H.data.menuList[C].menuId==30){var D=JIAOYAN_URL+"/index.html#/resourcelist?source=1&token="+H.data.menuList[C].token;A+='<li data-id="'+H.data.menuList[C].menuId+'"><a href="'+D+'" class="anav" target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}else{if(H.data.menuList[C].menuId==36){A+='<li data-id="'+H.data.menuList[C].menuId+'"><a target="_blank" href="'+window.location.origin+"/paperdata/#/examList?token="+window.sessionStorage.getItem("token")+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{if(i.name=="单元质检"&&H.data.menuList[C].menuId==17){A+='<li data-id="'+H.data.menuList[C].menuId+'" class="active"><a href="'+J+H.data.menuList[C].menuId+'" class="anav" target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}else{A+='<li data-id="'+H.data.menuList[C].menuId+'"><a href="'+J+H.data.menuList[C].menuId+'" class="anav" target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}}}}}if(typeof H.data.greatTeacherClassroom!=="undefined"&&H.data.greatTeacherClassroom.length){A+='<li class="dropdown dropdown-hover">';A+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">名师课堂<span class="caret"></span></a>';A+='  <ul role="menu" class="dropdown-menu">';for(var C=0;C<H.data.greatTeacherClassroom.length;C++){A+='<li><a class="menu-zhongqing-link" data-manage="0" data-menuId="'+H.data.greatTeacherClassroom[C].menuId+'" href="javascript:;">'+H.data.greatTeacherClassroom[C].menuName+"</a></li>"}if(typeof H.data.greatTeacherClassroomManage!=="undefined"&&H.data.greatTeacherClassroomManage.length){for(var C=0;C<H.data.greatTeacherClassroomManage.length;C++){var K=H.data.greatTeacherClassroomManage[C];var z=C===0?"border-top: 1px solid #ccc":{};A+='<li><a style="'+z+'" data-manage="1" class="menu-zhongqing-link" data-menuId="'+K.menuId+'" href="javascript:;">'+K.menuName+"</a></li>"}}A+="  </ul>";A+="</li>"}if(typeof H.data.attachePropagateCourse!=="undefined"&&H.data.attachePropagateCourse.length){console.log("d.data.attachePropagateCourse",H.data.attachePropagateCourse);A+='<li class="dropdown dropdown-hover">';A+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">专递课堂<span class="caret"></span></a>';A+='  <ul role="menu" class="dropdown-menu">';for(var C=0;C<H.data.attachePropagateCourse.length;C++){A+='<li><a class="menu-zhongqing-link" data-manage="0" data-menuId="'+H.data.attachePropagateCourse[C].menuId+'" href="javascript:;">'+H.data.attachePropagateCourse[C].menuName+"</a></li>"}if(typeof H.data.attachePropagateCourseMange!=="undefined"&&H.data.attachePropagateCourseMange.length){console.log("d.data.attachePropagateCourseMange",H.data.attachePropagateCourseMange);for(var C=0;C<H.data.attachePropagateCourseMange.length;C++){var K=H.data.attachePropagateCourseMange[C];var z=C===0?"border-top: 1px solid #ccc":{};A+='<li><a style="'+z+'" data-manage="1" class="menu-zhongqing-link" data-menuId="'+K.menuId+'" href="javascript:;">'+K.menuName+"</a></li>"}}A+="  </ul>";A+="</li>"}if(H.data.moreList.length!=0){A+='<li class="dropdown dropdown-hover">';A+='  <a aria-expanded="false" role="button" href="#" class="dropdown-toggle anav" data-toggle="dropdown">更多<span class="caret"></span></a>';A+='  <ul role="menu" class="dropdown-menu">';for(var C=0;C<H.data.moreList.length;C++){if(H.data.moreList[C].menuId==13){var w=SZPJ_URL+"/survey/#/?token="+x;A+='<li><a href="'+w+'"  target="_blank">'+H.data.moreList[C].menuName+"</a></li>"}else{if(H.data.moreList[C].menuId==41){var w=SZPJ_URL+"/survey/#/?userType=24&token="+x;A+='<li><a href="'+w+'"  target="_blank">'+H.data.moreList[C].menuName+"</a></li>"}else{if(H.data.moreList[C].menuId==29){y=H.data.moreList[C].token;A+='<li><a href="javascript:;" class="stu-evaluate-btn">'+H.data.moreList[C].menuName+"</a></li>"}else{if(H.data.moreList[C].menuUrl!=""&&H.data.moreList[C].menuUrl!=null&&H.data.moreList[C].menuUrl!=undefined){var E=H.data.moreList[C].menuUrl;var x=sessionStorage.getItem("token");if(E.indexOf("?")>-1){E+="&token="+x}else{E+="?token="+x}A+='<li><a href="'+E+'"  target="'+Math.random()+'">'+H.data.moreList[C].menuName+"</a></li>"}else{A+='<li><a href="'+J+H.data.moreList[C].menuId+'"  target="_blank">'+H.data.moreList[C].menuName+"</a></li>"}}}}}A+="  </ul>";A+="</li>"}A+="  </ul>";A+='<div class="nav-header">   <div class="fl message-fl"><a href="../message/index.html" class="anav" data-toggle="tooltip" data-placement="bottom" title="消息中心"><i class="icon-messages"></i></a></div>   <div class="fl dropdown ">';if(H.data.headImage!=undefined){A+='   <img src="'+H.data.headImage+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}else{A+='   <img src="'+DEFAULT_AVATAR+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}var x=sessionStorage.getItem("token");var s="https://cdn1-school.ai-classes.com/fpupload/helpdoc/school/teacher/teacher_help.zip";var B=d.judgePlatfrom();var u="";if(i.isIndex){u+='           <li><a href="javascript:;" class="js-btn-indexsys">增删模块</a></li>';u+='           <li><a href="javascript:;" class="js-btn-indexdrag">模块布局</a></li>'}A+='       <ul role="menu" class="dropdown-menu tooltip-demo">'+u+'           <li><a href="../teauser/index.html?token='+x+'" target="'+Math.random()+'">个人中心</a></li>';if(true){A+=' <li><a target="_blank" href="'+s+'">使用手册</a></li> <li><a href="../vercontrol/timeline.html?token='+x+'" class="js-btn-SystemVersion" target="'+Math.random()+'">系统版本</a></li>'}if(B==1){A+='<li class="signout" data-toggle="tooltip" data-placement="bottom" title="退出"><i class="icon-signout js-btn-signout">&nbsp;</i></li>'}A+="       </ul>   </div></div>";A+="</div></nav>";if(i.isIndex){A+='<div class="sortabletools clearfix"><div class="tool"><div class="word">拖拽模块可任意调整布局，调整好后保存设置！</div><div class="fr" ><a class="dragged-cancel">取消</a><a class="dragged-save">保存</a></div></div></div>'}d(".fixed-nav").html(A);var t='<div id="slide-out" class="side-nav" >   <div  class="slide-logo"><img src="" /></div>       <ul class="slide-ul"><li class="crr"><a href="../index/index.html">首页</a></li>';for(var C=0;C<H.data.menuList.length;C++){if(H.data.menuList[C].menuUrl!=""&&H.data.menuList[C].menuUrl!=null&&H.data.menuList[C].menuUrl!=undefined){if(H.data.menuList[C].menuId==4){t+='<li  data-id="'+H.data.menuList[C].menuId+'"><a href="../resources/index.html?token='+x+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{if(H.data.menuList[C].menuId==23){t+='<li  data-id="'+H.data.menuList[C].menuId+'"><a href="../task/index.html?token='+x+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{if(H.data.menuList[C].menuId==36){t+='<li data-id="'+H.data.menuList[C].menuId+'"><a target="_blank" href="'+window.location.origin+"/paperdata/#/examList?token="+x+'" class="anav">'+H.data.menuList[C].menuName+"</a></li>"}else{t+='<li  data-id="'+H.data.menuList[C].menuId+'"><a href="'+H.data.menuList[C].menuUrl+'" class="anav"  target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}}}}else{if(H.data.menuList[C].menuId==30){var D=JIAOYAN_URL+"/index.html#/resourcelist?source=1&token="+H.data.menuList[C].token;t+='<li><a href="'+D+'" class="anav" target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}else{if(H.data.menuList[C].menuId==36){t+='<li data-id="'+H.data.menuList[C].menuId+'"><a href="'+window.location.origin+"/paperdata/#/examList?token="+window.sessionStorage.getItem("token")+'" class="anav" target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}else{t+='<li><a href="'+J+H.data.menuList[C].menuId+'" class="anav"  target="_blank">'+H.data.menuList[C].menuName+"</a></li>"}}}}if(typeof H.data.greatTeacherClassroom!=="undefined"&&H.data.greatTeacherClassroom.length){t+=' <li class="slide-more-container"><a href="javascript:;" class="slide-more">名师课堂<span class="fa arrow"></span></a>';t+='<ul class="slide-ul2">';for(var C=0;C<H.data.greatTeacherClassroom.length;C++){t+='<li><a class="menu-zhongqing-link" data-manage="0" data-menuId="'+H.data.greatTeacherClassroom[C].menuId+'" href="javascript:;">'+H.data.greatTeacherClassroom[C].menuName+"</a></li>"}if(typeof H.data.greatTeacherClassroomManage!=="undefined"&&H.data.greatTeacherClassroomManage.length){for(var C=0;C<H.data.greatTeacherClassroomManage.length;C++){var K=H.data.greatTeacherClassroomManage[C];var z={};t+='<li><a style="'+z+'" data-manage="1" class="menu-zhongqing-link" data-menuId="'+K.menuId+'" href="javascript:;">'+K.menuName+"</a></li>"}}t+="  </ul>";t+="</li>"}if(typeof H.data.attachePropagateCourse!=="undefined"&&H.data.attachePropagateCourse.length){t+=' <li class="slide-more-container"><a href="javascript:;" class="slide-more">专递课堂<span class="fa arrow"></span></a>';t+='<ul class="slide-ul2">';for(var C=0;C<H.data.attachePropagateCourse.length;C++){t+='<li><a class="menu-zhongqing-link" data-manage="0" data-menuId="'+H.data.attachePropagateCourse[C].menuId+'" href="javascript:;">'+H.data.attachePropagateCourse[C].menuName+"</a></li>"}if(typeof H.data.attachePropagateCourseMange!=="undefined"&&H.data.attachePropagateCourseMange.length){for(var C=0;C<H.data.attachePropagateCourseMange.length;C++){var K=H.data.attachePropagateCourseMange[C];var z={};t+='<li><a style="'+z+'" data-manage="1" class="menu-zhongqing-link" data-menuId="'+K.menuId+'" href="javascript:;">'+K.menuName+"</a></li>"}}t+="</ul>";t+="</li>"}if(H.data.moreList.length!=0){t+=' <li class="slide-more-container"><a href="javascript:;" class="slide-more">更多<span class="fa arrow"></span></a>';t+='<ul class="slide-ul2">';for(var C=0;C<H.data.moreList.length;C++){if(H.data.moreList[C].menuId==29){y=H.data.moreList[C].token;A+='<li><a href="javascript:;" class="stu-evaluate-btn">'+H.data.moreList[C].menuName+"</a></li>"}else{if(H.data.moreList[C].menuUrl!=""&&H.data.moreList[C].menuUrl!=null&&H.data.moreList[C].menuUrl!=undefined){t+='<li><a href="'+H.data.moreList[C].menuUrl+'"  target="_blank">'+H.data.moreList[C].menuName+"</a></li>"}else{t+='<li><a href="'+J+H.data.moreList[C].menuId+'"  target="_blank">'+H.data.moreList[C].menuName+"</a></li>"}}}t+="</ul>";t+="</li>"}t+="</ul>";t+="</div>";d("body").append(t);d.getLogo();d(".stu-evaluate-btn").off("click").on("click",function(){console.log(22);d.ajax({url:BASE_API_URL+"/evaluation-service/home/load-only-teacher?r="+Math.random(),type:"GET",dataType:"json",beforeSend:function(L){L.setRequestHeader("Authorization",q)},success:function(L){if(L.code==1){if(L.data.onlyTeacher){if(L.data.msg){layui.use(["layer"],function(){var M=layui.layer;M.msg(L.data.msg,{time:3500})})}else{window.open(SZPJ_URL+"/xspingjia/index.html#/mark?periodId="+L.data.periodId+"&token="+y)}}else{window.open(SZPJ_URL+"/xspingjia/index.html#/home?token="+y)}}},error:function(L){d.getErrorMsg(L,"")}})});d(".menu-zhongqing-link").each(function(){var N=d(this);var O=d.getToken();var M=N.attr("data-menuid");var L=N.attr("data-manage");N.attr("target","_blank");d.ajax({url:BASE_API_URL+"/business-service-general/login/zq/user",type:"get",dataType:"json",data:{r:Math.random(),nav:M,manage:L,token:O},beforeSend:function(P){P.setRequestHeader("Authorization",O)},success:function(Q){var P=Q.data;if(P.indexOf("http")<0){P="http://"+P}N.attr("href",P)},error:function(P){}})});d(".navbar-toggle-btn").off("click").on("click",function(){d("#slide-out").velocity({"margin-left":[0,-1*250]},{duration:300,queue:false,easing:"easeOutQuad"});var N=d("body");var L=d('<div id="sidenav-overlay"></div>');var M=N.innerWidth();N.css("overflow","hidden");N.width(M);L.css("opacity",0).click(function(){r();L.velocity({opacity:0},{duration:300,queue:false,easing:"easeOutQuad",complete:function(){d(this).remove()}})});d("body").append(L);L.velocity({opacity:0.7},{duration:300,queue:false,easing:"easeOutQuad",})});var r=function(L){d("body").css({overflow:"",width:""});d("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:false,easing:"easeOutQuad",complete:function(){d(this).remove()}});d("#slide-out").velocity({"margin-left":[-1*250,0]},{duration:200,queue:false,easing:"easeOutCubic"})};d(".slide-more").off("click").on("click",function(){d(this).parent("li").toggleClass("active")});d("li.dropdown-hover").off("click.bs.dropdown.data-api").find(".dropdown-menu").css("z-index",1200);d("li.dropdown-hover").mouseover(function(){d(this).addClass("open")}).mouseout(function(){d(this).removeClass("open")});d(".js-btn-indexsys").off("click").on("click",function(){layui.use(["layer"],function(){var L=layui.layer;L.open({type:1,closeBtn:1,btnAlign:"c",move:false,shade:[0.5,"#000000"],shadeClose:true,title:"增删模块",skin:"ecampus-class",area:["800px","380px"],content:d("#popup-indexsys"),btn:["确定"],success:function(M,N){d.getAllModules()},yes:function(N,M){var O="";d(M).find("input[name=allModules]").not("input[name=allModules]:checked").each(function(){O+=d(this).val()+","});if(O.substr(O.length-1)==","){O=O.substr(0,O.length-1)}var P=d.getToken();d.ajax({url:BASE_API_URL+"/api-service-general/indexes/modules",type:"put",dataType:"json",data:{r:Math.random(),moduleIds:O},beforeSend:function(Q){Q.setRequestHeader("Authorization",P)},success:function(Q){if(Q.code==1){L.close(N);d.inits({isFirst:false})}else{L.msg(n.msg,{time:3000})}},error:function(Q){d.getErrorMsg(Q,"保存设置")}})},btn2:function(N,M){L.close(N)}})})});d(".js-btn-indexdrag").off("click").on("click",function(){d.openSortable()});d(".dragged-cancel").off("click").on("click",function(){d.closeSortable()});d(".dragged-save").off("click").on("click",function(){d.saveSortable()});d.getLogo();d.getUserRole();d.getSchoolRole()}else{if((i.isResources||i.name=="个人中心")&&m==1){var A='<nav class="navbar navbar-static-top navbar-fixed-top" role="navigation">   <div class="navbar-header-module">       <a class="navbar-brand"><img src=""></a>       <span class="mname">'+i.name+'</span>   </div>   <div class="navbar-right">       <div class="nav-header">';A+='<div class="fl dropdown ">';if(H.data.headImage!=undefined){A+='   <img src="'+H.data.headImage+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}else{A+='   <img src="'+DEFAULT_AVATAR+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}var s="https://cdn1-school.ai-classes.com/fpupload/helpdoc/school/teacher/teacher_help.zip";var B=d.judgePlatfrom();A+='                <ul role="menu" class="dropdown-menu tooltip-demo">                   <li><a href="../teauser/index.html">个人中心</a></li>';if(B==1){A+='<li class="signout" data-toggle="tooltip" data-placement="bottom" title="退出"><i  class="icon-signout js-btn-signout">&nbsp;</i></li>'}A+="               </ul>";A+="           </div>      </div>   </div></nav>";d(".fixed-nav").html(A);d.getLogo();d.getUserRole();d.getSchoolRole()}else{var A='<nav class="navbar navbar-static-top navbar-fixed-top" role="navigation">   <div class="navbar-header-module">       <a href='+i.url+' class="navbar-brand"><img src=""></a>       <span class="mname">'+i.name+'</span>   </div>   <div class="navbar-right">       <div class="nav-header">';A+='           <div class="fl message-fl"><a href="../message/index.html" class="anav" data-toggle="tooltip" data-placement="bottom" title="消息中心"><i class="icon-messages"></i></a></div>           <div class="fl dropdown ">';if(H.data.headImage!=undefined){A+='   <img src="'+H.data.headImage+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}else{A+='   <img src="'+DEFAULT_AVATAR+'" class="head dropdown-toggle" aria-expanded="false" data-toggle="dropdown"  role="button">'}var s="https://cdn1-school.ai-classes.com/fpupload/helpdoc/school/teacher/teacher_help.zip";var B=d.judgePlatfrom();A+='                <ul role="menu" class="dropdown-menu tooltip-demo">                   <li><a href="../teauser/index.html" target="'+Math.random()+'">个人中心</a></li>';if(true){A+='           <li><a target="_blank" href="'+s+'">使用手册</a></li>           <li><a href="../vercontrol/timeline.html" class="js-btn-SystemVersion" target="'+Math.random()+'">系统版本</a></li>'}if(B==1){A+='<li class="signout" data-toggle="tooltip" data-placement="bottom" title="退出"><i  class="icon-signout js-btn-signout">&nbsp;</i></li>'}A+="               </ul>";A+="           </div>      </div>   </div></nav>";d(".fixed-nav").html(A);d("#local").addClass("hidden");if(d.GetUrlParam("crowFeetFlag")==="1"){d("#local").click()}if(d.GetUrlParam("crowFeetFlag")==="2"){layer.open({closeBtn:0,btnAlign:"c",move:false,resize:false,area:["400px"],shade:[0.5,"#000000"],shadeClose:true,type:1,title:false,content:d("#UnBind"),success:function(L,M){d("#UnBind").find(".close").off("click").on("click",function(){layer.close(M)});d("#UnBind").find(".cancel").off("click").on("click",function(){layer.close(M)});d("#UnBind").find(".ok").off("click").on("click",function(){d.ajax({url:BASE_API_URL+"/api-service-resource/jbresources/unbunding-ncaccounts?r="+Math.random(),type:"POST",dataType:"json",data:{},beforeSend:function(N){N.setRequestHeader("Authorization",d.getToken())},success:function(N){layer.close(M);layui.layer.msg("解绑成功",{offset:"80px"})},error:function(N){layui.layer.msg("解绑失败",{offset:"80px"})}})})}})}d.getLogo();d.getUserRole();d.getSchoolRole()}}}},error:function(r){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(r)}else{d.getErrorMsg(r,"公共导航")}}})}if(d(".navbar-static-top").find(".navbar-header-module").length>0){d(".navbar-right").css("width","calc(100% - 500px)")}d('[data-toggle="tooltip"]').tooltip();if(i.thepage!=""&&i.thepage!==undefined){d(".nav li").each(function(){if(d(this).attr("data-id")==i.thepage){d(".nav li").removeClass("active");d(this).addClass("active")}})}d(".js-btn-signout").off("click").on("click",function(){d.ecSignOut()});var l=navigator.userAgent;if(l.match(/axpzhkt/i)||l.match(/impad/i)||l.match(/imphone/i)){if(i.type=="editcard"){d(".wrapper.wrapper-content").css("padding","20px 3px")}else{if(i.type=="resource"){d(".wrapper.wrapper-content").css("padding","94px 30px 20px 30px")}else{d(".wrapper.wrapper-content").css("padding","20px 30px")}}d(".fixed-nav").remove();d(".footer").remove();if(!sessionStorage.getItem("schoolId")){var p=loadSchoolConfig();if(p.userId){var k=typeof p.schoolId=="undefined"?0:p.schoolId;sessionStorage.setItem("schoolId",k)}}}else{d.getIsNotPc({_b:window.sessionStorage.getItem("lw_schoolIp"),type:i.type})}if(d.getRequest("pageSource")!="schoolGroup"){d.getPasswordPopup(h.updatePasswordCallback)}else{if(h.updatePasswordCallback&&typeof h.updatePasswordCallback=="function"){h.updatePasswordCallback()}}}})},getUserRole:function(h){var i=loadSchoolConfig();if(i.userId){if(i.roles[0]==1){d(".navbar-brand").attr("src","javascript:;");d(".message-fl").remove();d(".tooltip-demo li").not(".signout").remove()}}else{if(i.errObj){d.getErrorMsg(i.errObj,"获取用户角色",{refreshTokenCallback:function(){d.getUserRole()},storageName:"common-user-role"})}}},getSchoolRole:function(){var h=loadSchoolConfig();if(h.userId&&h.showSysVersion!=1){d(".js-btn-SystemVersion").parent().remove()}},GetUrlParam:function(h){var i=new RegExp("(^|&)"+h+"=([^&]*)(&|$)");var j=window.location.search.substr(1).match(i);if(j!=null){return decodeURI(j[2])}return null},localsources:function(){d("#local").off("click").on("click",function(){d.ajax({url:BASE_API_URL+"/api-service-resource/jbresources/bind-status?r="+Math.random(),type:"GET",dataType:"json",data:{},beforeSend:function(h){h.setRequestHeader("Authorization",d.getToken())},success:function(h){if(h.data==="0"){layer.open({closeBtn:0,btnAlign:"c",move:false,resize:false,area:["600px","280px"],shade:[0.5,"#000000"],shadeClose:true,type:1,title:false,content:d("#Bind"),success:function(i,j){d("#Bind .tip").text("");d("#Bind input").val("");d("#Bind").find(".close").off("click").on("click",function(){layer.close(j)});d("#Bind").find(".cancel").off("click").on("click",function(){layer.close(j)});d("#Bind").find(".ok").off("click").on("click",function(){if(d('#Bind input[name="user"]').val()===""){d("#Bind .tip").text("账号不能为空");return false}if(d('#Bind input[name="pwd"]').val()===""){d("#Bind .tip").text("密码不能为空");return false}d.ajax({url:BASE_API_URL+"/api-service-resource/jbresources/bind-ncaccounts?r="+Math.random(),type:"POST",dataType:"json",data:{ncUsername:d('#Bind input[name="user"]').val(),ncPassword:d('#Bind input[name="pwd"]').val()},beforeSend:function(k){d("#Bind .tip").text("");k.setRequestHeader("Authorization",d.getToken())},success:function(k){if(k.code===1){layui.layer.msg("绑定成功",{offset:"80px"});window.open("../local/index.html");layer.close(j)}else{d("#Bind .tip").text(k.msg)}},error:function(k){layui.layer.msg("绑定失败",{offset:"80px"})}})})}});return false}if(h.data==="1"){window.open("../local/index.html");return false}if(h.data==="2"){layer.open({closeBtn:0,btnAlign:"c",move:false,resize:false,area:["600px","280px"],shade:[0.5,"#000000"],shadeClose:true,type:1,title:false,content:d("#UnBind"),success:function(i,j){d("#Bind .tip").text("");d("#Bind input").val("");d("#Bind").find(".close").off("click").on("click",function(){layer.close(j)});d("#Bind").find(".cancel").off("click").on("click",function(){layer.close(j)});d("#Bind").find(".ok").off("click").on("click",function(){if(d('#Bind input[name="user"]').val()===""){d("#Bind .tip").text("账号不能为空");return false}if(d('#Bind input[name="pwd"]').val()===""){d("#Bind .tip").text("密码不能为空");return false}d.ajax({url:BASE_API_URL+"/api-service-resource/jbresources/bind-ncaccounts?r="+Math.random(),type:"POST",dataType:"json",data:{ncUsername:d('#Bind input[name="user"]').val(),ncPassword:d('#Bind input[name="pwd"]').val()},beforeSend:function(k){d("#Bind .tip").text("");k.setRequestHeader("Authorization",d.getToken())},success:function(k){if(k.code===1){layui.layer.msg("绑定成功",{offset:"80px"});window.open("../local/index.html");layer.close(j)}else{d("#Bind .tip").text(k.msg)}},error:function(k){layui.layer.msg("绑定失败",{offset:"80px"})}})})}});return false}},error:function(h){layui.layer.msg("获取用户绑定状态失败",{offset:"80px"})}})})},getLogo:function(){var h=loadSchoolConfig();if(h.userId){d(".navbar-brand img").attr("src",h.leftTopLogoUrl);d(".slide-logo img").attr("src",h.leftTopLogoUrl)}else{if(h.errObj){d.getErrorMsg(h.errObj,"LOGO加载",{refreshTokenCallback:function(){d.getLogo()},storageName:"common-logo"})}}},getstuLogo:function(){var h=loadSchoolConfig();if(h.userId){d(".navbar .logo img").attr("src",h.leftTopLogoUrl);if(h.photoUrl){d(".navbar .navbar-right .fl img").attr("src",h.photoUrl)}}else{if(h.errObj){d.getErrorMsg(h.errObj,"LOGO加载",{refreshTokenCallback:function(){d.getstuLogo()},storageName:"common-stu-logo"})}}},ecSignOut:function(){var j=d.getToken();var h=window.sessionStorage.getItem("lw_schoolIp");var i=window.sessionStorage.getItem("onlyRes");d.ajax({url:h+"linkWeb?m=userquit",type:"GET",dataType:"jsonp",jsonp:"callback",data:{token:j,r:Math.random(),onlyRes:i},beforeSend:function(k){k.setRequestHeader("Authorization",j)},success:function(k){if(k.code==1){removeCookieValue("schoolConfig");window.sessionStorage.removeItem("token");window.sessionStorage.removeItem("indexTip");window.location.href=k.data.url}else{layui.use(["layer"],function(){var l=layui.layer;l.msg("退出失败",{time:3000})})}},error:function(k){d.getErrorMsg(k,"退出",{refreshTokenCallback:function(){d.ecSignOut()},storageName:"common-sign-out"})}})},showWebIM:function(){var k=window.location.protocol+"//web.etiantian.com/js/ett/webim/webim-panel.html";var j=window.sessionStorage.getItem("webAX_jid"),n=window.sessionStorage.getItem("webAX_userType"),i=window.sessionStorage.getItem("webAX_schoolId"),m=window.sessionStorage.getItem("webAX_token"),l=window.sessionStorage.getItem("webAX_time"),h=window.sessionStorage.getItem("webAX_key");d.framebridge.handler({reviceMessage:function(p){var o=p.msg.cnt;if(o>0){d(".js-btn-webaixue .badge").html((o>99?"99+":o))}else{d(".js-btn-webaixue .badge").html("")}}});if(j!=null){d.framebridge.openDialog({windowId:"123456",windowClass:"webim_group_layout",target_url:k,width:262,height:590,queryString:{jid:j,userType:n,schoolId:i,webimtoken:m,webimtimestamp:l,webimkey:h},position:[100,20],autoOpen:false,autoCreate:true})}d(".js-btn-webaixue").off("click").on("click",function(){d.framebridge.openDialog({windowId:"123456",windowClass:"webim_group_layout",target_url:k,width:262,height:590,queryString:{jid:j,userType:n,schoolId:i,webimtoken:m,webimtimestamp:l,webimkey:h},position:[100,20]})})},chatForOne:function(i){var k={jid:0,userName:"",isSelf:0};var k=d.extend(k,i);if(typeof k.jid=="undefined"){return false}if(parseInt(k.jid)<=0){return false}if(k.isSelf==1){return false}var j=window.location.protocol+"//web.etiantian.com/js/ett/webim/webim-msg.html";var h="1";d.framebridge.openDialog({windowId:"msgDialogIM",windowClass:"webim_chat_layout",autoOpen:true,width:554,height:590,target_url:j,windowParams:{jid:k.jid},queryString:{jid:k.jid,uType:h},title:k.userName,titleType:1});d.framebridge.closeDialog({windowId:"webim-info"});d.framebridge.closeDialog({windowId:"webim-dialog"})},getWebAiXueParams:function(){var h=loadSchoolConfig();if(h.userId){window.sessionStorage.setItem("webAX_jid",h.jid);window.sessionStorage.setItem("webAX_userType",h.userType);window.sessionStorage.setItem("webAX_schoolId",h.schoolId)}else{if(h.errObj){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(h.errObj)}else{d.getErrorMsg(h.errObj,"获取web爱学请求参数",{refreshTokenCallback:function(){d.getWebAiXueParams()},storageName:"common-web-aixue-params"})}}}},getNavNotice:function(){var h=d.getToken();d.ajax({url:BASE_API_URL+"/api-service-general/notice/newest",type:"GET",dataType:"json",data:{r:Math.random()},beforeSend:function(i){i.setRequestHeader("Authorization",h)},success:function(l){if(l.code==1){if(l.data){if(l.data.headImg){d(".navbar .avatar").attr("src",l.data.headImg)}else{d(".navbar .avatar").attr("src",DEFAULT_AVATAR)}if(l.data.studentNoticeInfoResultDTO&&l.data.studentNoticeInfoResultDTO.noticeId){var j=l.data.studentNoticeInfoResultDTO;var k="../stumessage/index.html";var i=j.noticeId;if(j.noticeType==1){k="../stumessage/schoolparticulars.html";sessionStorage.setItem("noticesId",i)}else{if(j.noticeType==2){k="../stumessage/classparticulars.html";sessionStorage.setItem("activityId",i)}}d(".navbar .notice a").attr("href",k);d(".navbar .n-link").text(j.noticeTitle);d(".navbar .pub-time").text(j.noticeTime);d(".navbar .notice").show()}}}},error:function(i){d.getErrorMsg(i,"获取通知及头像失败");d.getErrorMsg(i,"获取通知及头像失败",{refreshTokenCallback:function(){d.getNavNotice()},storageName:"common-nav-notice"})}})},isHandIOS:function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||(navigator.userAgent.includes("Mac")&&"ontouchend" in document)},getIsNotPc:function(p){var h={_b:"",type:""};var h=d.extend(h,p);var o=new Date().getFullYear();var n="Copyright ©"+o+" 北京龙之门网络教育技术股份有限公司";var m='龙之门教育集团<span class="ml5">|</span><span class="ml5 mr5">'+n+"</span>";var l='<span class="ml5 mr5"><img src="//cdn1-school.ai-classes.com/ecampus/images/footer01.png"></span><a style="color:#333;" href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">京ICP备16039898号-5</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color:#333;" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010202007439" target="_blank">京公网备案 11010202007439号</a>　　建议使用<a class="foot-a" href="https://www.google.cn/intl/zh-CN/chrome/" target="_blank">谷歌浏览器</a>';var k='<a class="to_report" target="_blank" href="" style="margin-right: 10px;">举报</a><a class="to_complaint" target="_blank" href="">评价</a>';var i=d.getRequest("vid");function j(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||d.isHandIOS()){if(i==undefined){if(h.type==0){d(".footer").css({"padding-top":0,"margin-top":0,height:"156"})}if(d(window).width()<=1280){if(h.type=="resource"){d(".wrapper-content").css("padding","158px 30px 20px 30px")}else{d(".wrapper-content").css("padding","90px 30px 20px 30px")}}d(".dropdown-menu").css("left","-38px");var q='<div class="footer-app"><div class="footer-app-top"><ul class="row"><li class="col-lg-4 col-md-4 col-sm-4 col-xs-4"><span class="vx-app vx-app01"><span class="tit-pos tit-pos01">官方微信</span></span></li><li class="col-lg-4 col-md-4 col-sm-4 col-xs-4"><span class="vx-app vx-app02"><span class="tit-pos tit-pos02">爱学app</span></span></li><li class="col-lg-4 col-md-4 col-sm-4 col-xs-4"><span class="vx-app vx-app03"><span class="tit-pos tit-pos03">爱学派</span></span></li></ul></div><div class="footer-app-bottom"><span class="s12">'+m+'</span><span class="s12">'+n+'</span><span class="s12">'+l+'</span><span class="s12" style="margin-left: 10px;">'+k+"</span></div></div>";d(".footer").html(q);if(h.type==0){d(".row").css("margin-right","0px");d(".col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12").css("padding-right","0px")}d(".message-fl").remove();d(".slide-more").parents("li").before('<li><a href="../message/index.html">消息中心</a></li>')}else{if(h.type==0){d(".fixed-nav").empty();d(".footer").remove()}else{if(h.type==3){d(".fixed-nav").remove()}else{if(h.type==1){d(".picScroll-top").css("top","150px");d(".fixed-nav").remove()}}}}}else{var q='<div class="footer-main clearfix">   <div class="footer-main-left">       <p>'+m+"</p>       <p>"+l+"</a></p>       <p>"+k+'</p>   </div>   <div class="footer-main-right" style="display: none;"><dl><dt class="footer-li01"></dt><dd class="">官方微信</dd><div class="animate-box"><div class="vx"></div></div></dl><dl><dt class="footer-li02"></dt><dd class="common-footer-wordstyle footer-li02-word">爱学app</dd><div class="animate-box love-app aixuepai"><div class="love-app-top"></div></div></dl><dl><dt class="footer-li03"></dt><dd class="common-footer-wordstyle footer-li03-word">爱学派</dd><div class="animate-box love-app"><div class="love-app-top love-pai"></div><div class="love-app-bottom"><a href="https://web.etiantian.com/ett20/app/aixue-pad.jsp">立即下载</a></div></div></dl></div></div>';d(".footer").html(q);d(".footer-main-right dl").off().hover(function(){var s=d(this);s.find(".animate-box").show()},function(){var s=d(this);s.find(".animate-box").hide()});if(d(window).width()<=1280){if(h.type===0||h.type==="0"){d(".wrapper-content").css("padding","25px 50px 20px 50px")}else{if(h.type=="resource"){d(".wrapper-content").css("padding","158px 50px 20px 50px")}else{d(".wrapper-content").css("padding","110px 50px 20px 50px")}}}}var r=loadSchoolConfig();if(r.userId){d(".footer-main-left").css({width:"100%","text-align":"center"});sessionStorage.setItem("schoolId",r.schoolId);if(r.isHasLink!==1){d(".to_report").html("");d(".to_complaint").html("")}else{d(".footer-app-top").hide();d(".to_report").attr("href","http://system.eduyun.cn/bmp-web/sysAppReport/appReport?appId=68mMzCzZjKDH9rWTWnoz20BRQNuaaLBk&userId="+r.userId);d(".to_complaint").attr("href","http://system.eduyun.cn/bmp-web/getSpAppDetail_index?appId=68mMzCzZjKDH9rWTWnoz20BRQNuaaLBk&userId="+r.userId)}}}j()},openSortable:function(){d(".sortabletools").css("display","block");d(".sortabletools").animate({top:"0",zIndex:9999},300,function(){d("body").animate({paddingTop:"60"},300,function(){d(".ibox-title").addClass("dd-ibox-title");d(".aa").sortable({group:"aa",handle:".dd-ibox-title",onDrop:function(i,h,j){j(i,h);i.find(".refresh-link").trigger("click")},onDragStart:function(i,h,j){var l=i.offset(),k=h.rootGroup.pointer;adjustment={left:k.left-l.left,top:k.top-l.top};j(i,h)},onDrag:function(i,h){i.css({left:h.left-adjustment.left,top:h.top-adjustment.top})}})})})},closeSortable:function(){d(".sortabletools").css("display","none");d(".sortabletools").animate({top:"0",zIndex:1},300,function(){d("body").animate({paddingTop:"0"},300,function(){d(".ibox-title").removeClass("dd-ibox-title");d.inits({isFirst:false})})})},saveSortable:function(){var k=d.getToken();var j=[];var i=[];var h=[];d(".aa").eq(0).find(".ibox").each(function(){j.push(d(this).attr("data-id"))});d(".aa").eq(1).find(".ibox").each(function(){i.push(d(this).attr("data-id"))});d(".aa").eq(2).find(".ibox").each(function(){h.push(d(this).attr("data-id"))});d.ajax({url:BASE_API_URL+"/api-service-general/indexes/modules/sort",type:"put",dataType:"json",data:{r:Math.random(),leftModuleIds:j.toString(),centerModuleIds:i.toString(),rightModuleIds:h.toString()},beforeSend:function(l){l.setRequestHeader("Authorization",k)},success:function(l){if(l.code==1){d(".sortabletools").css("display","none");d(".sortabletools").animate({top:"0",zIndex:1},300,function(){d("body").animate({paddingTop:"0"},300,function(){d(".ibox-title").removeClass("dd-ibox-title")})})}else{layui.use(["layer"],function(){var m=layui.layer;m.msg(l.msg,{time:3000})})}},error:function(l){d.getErrorMsg(l,"模块布局")}})},getPasswordPopup:function(h){var j=d.getToken();var i=d.judgePlatfrom();if(i==0){return}if(d.getCookieByName("verifyPasswordFlag")==null||md5(j)!==d.getCookieByName("verifyPasswordFlag")){d.ajax({url:BASE_API_URL+"/api-service-general/users/verify-password",type:"GET",dataType:"json",data:{r:Math.random(),},beforeSend:function(k){k.setRequestHeader("Authorization",j)},success:function(l){if(l.code==1){if(l.data.flag==false||l.data.flag=="false"){var k="";k+='<div class="pwd-box-popup">';k+='    <div class="passHelp">由于您的密码太过于简单，需要修改密码后再使用</div>';k+='    <div class="passDiv">';k+="        <label>用户名：</label>";k+='        <input name="" type="text" value="'+l.data.userName+'" readonly="readonly" />';k+="    </div>";k+='    <div class="passTip"></div>';k+='    <div class="passDiv">';k+="        <label>新密码：</label>";k+='        <input id="password" name="" type="password" value="" data-level="0" placeholder="6-16个字符，大写字母/小写字母/数字/下划线至少包含三种" />';k+="    </div>";k+='    <ul class="pwd-level" id="pwd-level">';k+='        <li class="low">弱</li>';k+='        <li class="mid">中</li>';k+='        <li class="strong">强</li>';k+="    </ul>";k+='    <div class="passTip" id="passwordTip"></div>';k+='    <div class="passDiv">';k+="        <label>再次输入：</label>";k+='        <input id="repassword" name="" type="password" value="" placeholder="" />';k+="    </div>";k+='    <div class="passTip" id="repasswordTip"></div>';k+="</div>";layui.use(["layer"],function(){var m=layui.layer;m.open({type:1,closeBtn:0,btnAlign:"c",move:false,shade:[0.5,"#000000"],shadeClose:false,title:"提示",skin:"ecampus-class",area:["650px","420px"],content:k,btn:["确定"],yes:function(p,n){var t=d("#password").val();var s=t.length;var q=d("#repassword").val();if(s<6||s>16){d("#passwordTip").html("密码长度为6-16个字符");return}var o=/^(?=.*\d)(?=.*[A-Za-z])/;if(!o.test(t)){d("#passwordTip").html("密码必须包含数字和字母");return}var r=/^\w{6,16}$/;if(!r.test(t)){d("#passwordTip").html("密码只能包含字母、数字、下划线!");return}if(d("#password").attr("data-level")<2){d("#passwordTip").html("密码强度太弱，大写字母/小写字母/数字/下划线至少包含三种");return}if(t!=q){d("#repasswordTip").html("两次输入的不一致，请重新输入");return}d.ajax({url:BASE_API_URL+"/api-service-general/users/ett-user/password/"+t,type:"PUT",dataType:"json",data:{r:Math.random(),},beforeSend:function(u){u.setRequestHeader("Authorization",j)},success:function(u){if(u.code==1){m.close(p);if(h&&typeof h=="function"){h()}d.setCookieValue("verifyPasswordFlag",md5(j))}else{d("#repasswordTip").html(u.msg)}},error:function(u){d.getErrorMsg(u,"修改密码")}})}})})}else{if(h&&typeof h=="function"){h()}d.setCookieValue("verifyPasswordFlag",md5(j))}}else{layui.use(["layer"],function(){var m=layui.layer;m.msg(l.msg,{time:3000})});if(h&&typeof h=="function"){h()}}},error:function(k){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(k)}else{d.getErrorMsg(k,"密码强度验证")}if(h&&typeof h=="function"){h()}}})}},timestampToTime:function(n){var j=new Date(n),p=j.getFullYear()+"-",q=(j.getMonth()+1<10?"0"+(j.getMonth()+1):j.getMonth()+1)+"-",o=j.getDate()+" ",l=j.getHours()+":",i=j.getMinutes()+":",k=j.getSeconds();return p+q+o+""+l+i+k},isIE:function(){if(!!window.ActiveXObject||"ActiveXObject" in window){return true}else{return false}},getIEVersion:function(){var l=navigator.userAgent;var i=l.indexOf("compatible")>-1&&l.indexOf("MSIE")>-1;var k=l.indexOf("Edge")>-1&&!i;var m=l.indexOf("Trident")>-1&&l.indexOf("rv:11.0")>-1;if(i){var h=new RegExp("MSIE (\\d+\\.\\d+);");h.test(l);var j=parseFloat(RegExp["$1"]);if(j==7){return 7}else{if(j==8){return 8}else{if(j==9){return 9}else{if(j==10){return 10}else{return 6}}}}}else{if(k){return"edge"}else{if(m){return 11}else{return -1}}}},htmlspecialchars:function(h){h=h.replace(/</g,"&lt;");h=h.replace(/>/g,"&gt;");h=h.replace(/"/g,"&quot;");h=h.replace(/'/g,"&#039;");return h},getPwdScore:function(p){var l=0;if(!p){return l}else{var r=p.length;if(r<7){l+=5}else{if(r>=7&&r<=9){l+=10}else{l+=20}}var q=0,k=0,o=0,h=0;for(var m=0;m<r;m++){var j=p.charCodeAt(m);var n=a(j);switch(n){case 1:q++;break;case 2:o++;break;case 3:k++;break;case 4:h++;break;default:break}}if(o>0&&k==0){l+=10}else{if(o==0&&k>0){l+=10}else{if(o>0&&k>0){l+=25}}}if(q>2){l+=20}else{if(q>0&&q<=2){l+=10}}if(h==1){l+=10}else{if(h>1){l+=25}}if(o>0&&k>0&&q>0&&h>0){l+=5}else{if((o>0||k>0)&&q>0&&h>0){l+=3}else{if((o>0||k>0)&&q>0&&h==0){l+=2}}}return l}},commonAjax:function(k,l,i){var m="";if(k.token){m=k.token;delete k.token}else{m=d.getToken()}var j={url:k.url,type:k.type,async:true,dataType:"json",beforeSend:function(n){n.setRequestHeader("Authorization",m)},data:l,success:function(n){if(n&&(n.code==1)){i.success(n)}else{d.getErrorMsgCode((n&&n.msg)||"网络异常，请稍后再试呦~")}},error:i.error};i.complete&&(j.complete=i.complete);var h=d.extend(j,k);d.ajax(h)},closeAllLayer:function(h){layui.use("layer",function(){var i=layui.layer;i.closeAll();if(h){setTimeout(function(){h()},100)}})},judgeRole:function(){var h=loadSchoolConfig();if(h.userId){if(h.roles[0]==1){window.location.href="../index/stuindex.html"}}else{if(h.errObj){if(d.getRequest("pageSource")=="areaPlat"){d.resErrorHandle(h.errObj)}else{d.getErrorMsg(h.errObj,"获取用户角色")}}}},getCookieByName:function(i){var h,j=new RegExp("(^| )"+i+"=([^;]*)(;|$)");if(h=document.cookie.match(j)){return decodeURIComponent(h[2])}else{return null}},setCookieValue:function(h,i){var j=new Date();j.setTime(j.getTime()+8*60*60*1000);document.cookie=h+"="+encodeURIComponent(i)+";expires="+j.toUTCString()+";path=/"},judgePlatfrom:function(){var i=loadSchoolConfig();var h;if(i.userId){h=i.showLogout;if(i.ssoAddress){window.sessionStorage.setItem("ssoAddress",i.ssoAddress);d.setCookieValue("ssoAddress",i.ssoAddress)}}return h},compressFile:function(j,m){if(j.type.indexOf("image")==-1){m(j);return}var l=j;var i=navigator.userAgent;var k=i.indexOf("Edge")>-1||i.indexOf("MSIE")>-1||i.indexOf("Trident/")>-1;if(k){m(j)}else{if(d.checkFileSupport()){var h=new FileReader();h.readAsDataURL(l);h.onload=function(o){var n=new Image();n.src=o.target.result;n.onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d"),z=n.width,x=n.height,v="";t.width=z;t.height=x;r.drawImage(n,0,0,z,x);v=t.toDataURL("image/jpeg");var w=v.split(","),q=w[0].match(/:(.*?);/)[1],s=atob(w[1]),u=s.length,y=new Uint8Array(u);while(u--){y[u]=s.charCodeAt(u)}var p=new window.File([new Blob([y],{type:q})],"test.jpeg",{type:"image/jpeg"});m(p)}}}else{m(j)}}},checkFileSupport:function(){try{new File(["foo"],"foo.txt",{type:"text/plain",});return true}catch(h){return false}}});d(document).on("click",".gb",function(){d(".hide-img").hide()});d(document).on("change","#password",function(){f(d(this).val())});d(document).on("keyup","#password",function(){f(d(this).val())});d(document).on("keyup","#repassword",function(){d("#passwordTip").html("");d("#repasswordTip").html("")});function a(h){if(h>=48&&h<=57){return 1}if(h>=65&&h<=90){return 2}if(h>=97&&h<=122){return 3}else{return 4}}function f(h){var i=d.getPwdScore(h);if(h){if(i>45&&i<=60){d("#pwd-level .low").attr("class","low active");d("#pwd-level .mid").attr("class","mid active");d("#pwd-level .strong").attr("class","strong");d("#password").attr("data-level","2")}else{if(i>60){d("#pwd-level .low").attr("class","low active");d("#pwd-level .mid").attr("class","mid active");d("#pwd-level .strong").attr("class","strong active");d("#password").attr("data-level","3")}else{d("#pwd-level .low").attr("class","low active");d("#pwd-level .mid").attr("class","mid");d("#pwd-level .strong").attr("class","strong");d("#password").attr("data-level","1")}}}else{d("#pwd-level li").removeClass("active")}d("#passwordTip").html("");d("#repasswordTip").html("")}function c(){var h=d.ajax;d.ajax=function(i){var k={error:function(l,n,m){}};if(i.error){k.error=i.error}var j=d.extend(i,{error:function(l,n,m){k.error(l,n,m);if((k.error+"").indexOf("getErrorMsg")<0){d.getErrorMsg(l,"")}}});return h(j)}}}));function getFont(b,a){if(a.level==0){return{color:"#000","font-weight":"bold"}}else{if(a.level==1){return{color:"#000"}}else{return{color:"#666"}}}}function onTokenInit(a){sessionStorage.setItem("token",a)}function onTokenRefresh(a){sessionStorage.setItem("token",a);flutterAjaxAgain=true};